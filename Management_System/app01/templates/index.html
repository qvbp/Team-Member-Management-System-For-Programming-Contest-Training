{% extends 'layout.html' %}
{% load static %}
{% block css %}
    <style>
        a:hover {
            color: #0044cc; /* 设置悬停时的字体颜色 */
        }
    </style>

{% endblock %}
{% block content %}
    <div class="container" style="margin-top: 20px;">
        <div class="panel panel-default" style="margin-top:40px;">
            <div class="panel-heading"><i class="fa fa-bar-chart" aria-hidden="true"></i> 数据柱状图</div>
            <div class="panel-body">
                <div id="m2" style="width: 100%;height: 400px;"></div>
            </div>
        </div>

        <div class="panel panel-warning">
            <div class="panel-heading">
                <span class="glyphicon glyphicon-th-list" aria-hidden="true"></span>
                数据饼图
            </div>
            <div class="panel-body">
                <div id="m1" style="width: 100%;height: 500px;"></div>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-4">
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <span class="glyphicon glyphicon-th-list" aria-hidden="true"></span>
                        刷题总数排名
                    </div>
                    <div class="panel-body">
                        <!-- Table -->
                        <table class="table table-bordered">
                            <thead>
                            <tr>
                                <th>#</th>
                                <th>姓名</th>
                                <th>性别</th>
                                <th>总做题数</th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for obj in query_set_1 %}
                                <tr>
                                    <th scope="row">{{ forloop.counter }}</th>
                                    <td>{{ obj.name.name }}</td>
                                    <td>{{ obj.get_gender_display }}</td>
                                    <td>{{ obj.solved_all }}</td>
                                </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
{#                <div class="clearfix">#}
{#                    <ul class="pagination">#}
{#                        {{ page_string_1 }}#}
{#                    </ul>#}
{#                </div>#}
            </div>

            <div class="col-sm-4">
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <span class="glyphicon glyphicon-th-list" aria-hidden="true"></span>
                        CodeForce Rating分数排名
                    </div>
                    <div class="panel-body">
                        <!-- Table -->
                        <table class="table table-bordered">
                            <thead>
                            <tr>
                                <th>#</th>
                                <th>姓名</th>
                                <th>性别</th>
                                <th>rank分数</th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for obj in query_set_2 %}
                                <tr>
                                    <th scope="row">{{ forloop.counter }}</th>
                                    <td>{{ obj.name.name }}</td>
                                    <td>{{ obj.get_gender_display }}</td>
                                    <td>{{ obj.rating }}</td>
                                </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="col-sm-4">
                <div class="panel panel-primary">
                    <div class="panel-heading ">
                        <span class="glyphicon glyphicon-th-list" aria-hidden="true"></span>
                        AtCoder Rating分数排名
                    </div>
                    <div class="panel-body ">
                        <!-- Table -->
                        <table class="table table-bordered">
                            <thead>
                            <tr>
                                <th>#</th>
                                <th>姓名</th>
                                <th>性别</th>
                                <th>rank分数</th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for obj in query_set_3 %}
                                <tr>
                                    <th scope="row">{{ forloop.counter }}</th>
                                    <td>{{ obj.name.name }}</td>
                                    <td>{{ obj.get_gender_display }}</td>
                                    <td>{{ obj.rating }}</td>
                                </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <div class="panel panel-default">
            <div class="panel-heading" >
                <span class="glyphicon glyphicon-plane" aria-hidden="true"></span>
                各大OJ传送门
            </div>
            <div class="panel-body" >
                <div class="container">
                    <div class="col-sm-4">
                        <a href="https://codeforces.com/" target="_blank"><img height="65" style="height: 42px;" alt="Codeforces" title="Codeforces"
                           src="//codeforces.org/s/55131/images/codeforces-sponsored-by-ton.png"></a>
                    </div>
                    <div class="col-sm-4">
                        <a href="https://ac.nowcoder.com/" target="_blank">
                            <img src="//static.nowcoder.com/acm/images-acm/logo.png" style="width:139px;height:42px;" alt="">
                        </a>
                    </div>
                    <div class="col-sm-4">
                        <a href="https://atcoder.jp/" style="text-decoration: none; color: #0f0f0f; font-size: 20px;" target="_blank">
                            <img src="{% static '/img/atcoder.png' %}" alt="" style="height:42px;">
                            AtCoder
                        </a>
                    </div>
                </div>
                <div class="container" style="margin-top: 20px;">
                    <div class="col-sm-4">
                        <a href="https://vjudge.net/" style="text-decoration: none; color: #0f0f0f; font-size: 20px;" target="_blank">
                            <img src="https://vjudge.net/static/bundle/11b24ab2156955d8f3fa.ico" style="height:42px;" alt="">
                            VJudge
                        </a>
                    </div>
                    <div class="col-sm-4">
                        <a data-v-0640126c="" data-v-1d35343d="" href="/" colorscheme="default" class="color-default">
                            <img src="https://fecdn.luogu.com.cn/luogu/logo.png?0fdd294ff62e331d2f70e1a37ba4ee02" style="height:42px;" alt="">
                        </a>
                    </div>
                    <div class="col-sm-4">
                        <a href="https://leetcode.cn/">
                            <img src="{% static '/img/leetcode.png' %}" alt="" style="height:42px;">
                        </a>
                    </div>
                </div>
            </div>

        </div>
    </div>

{% endblock %}

{% block js %}
    <script src="{% static 'js/echarts.js' %}"></script>
    <script type="text/javascript">

        $(function () {
            // 做题数饼状图
            initPie_Solved();
            // 近七天做题数柱状图
            initBar_last_seven_days_Solved();

        })

        /**
         * 初始化做题数饼状图
         */

        function initPie_Solved() {
            // 基于准备好的dom，初始化echarts实例
            var myChart = echarts.init(document.getElementById('m1'));
            var option = {
                title: {
                    text: '集训队各oj刷题总数占比',
                    left: 'center'
                },
                tooltip: {
                    trigger: 'item'
                },
                legend: {
                    bottom: 0
                },
                series: [
                    {
                        name: '刷题数',
                        type: 'pie',
                        radius: '70%',
                        data: [],
                        emphasis: {
                            itemStyle: {
                                shadowBlur: 10,
                                shadowOffsetX: 0,
                                shadowColor: 'rgba(0, 0, 0, 0.5)'
                            }
                        }
                    }
                ]
            };

            $.ajax({
                url: "/chart/all_solved_pie/",
                type: "get",
                dataType: "JSON",
                success: function (res) {
                    if (res.status) {
                        option.series[0].data = res.data;
                        myChart.setOption(option);
                    }
                }
            })

        }

        /**
         * 初始化近七天做题数柱状图
         */
        function initBar_last_seven_days_Solved() {
            // 基于准备好的dom，初始化echarts实例
            var myChart = echarts.init(document.getElementById('m2'));

            // 指定图表的配置项和数据
            var option = {
                title: {
                    text: '集训队最近七天做题数',
                    textAlign: "auto",
                    left: "center",
                },
                tooltip: {},
                legend: {
                    data: [],  // 后台获取
                    bottom: 0
                },
                xAxis: {  // x轴
                    data: []  // 后台获取
                },
                yAxis: {},  // y轴
                series: []  // 后台获取
            };

            $.ajax({
                url: "/chart/students_solved_last_seven_days_bar/",
                type: "get",
                dataType: "JSON",
                success: function (res) {
                    // 将后台返回的数据，更新到option中。
                    if (res.status) {
                        option.legend.data = res.data.legend;
                        option.xAxis.data = res.data.x_axis;
                        option.series = res.data.series_list;

                        // 使用刚指定的配置项和数据显示图表。
                        myChart.setOption(option);
                    }
                }
            })
        }
    </script>
{% endblock %}